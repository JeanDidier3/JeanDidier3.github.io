<html>

<head>
    <meta charset="utf-8" />
    <script src="https://unpkg.com/pdf-lib@1.4.0"></script>
    <script src="https://unpkg.com/downloadjs@1.4.7"></script>
</head>

<body>
    <p>Click the button to modify an existing PDF document with <code>pdf-lib</code></p>
    <button onclick="modifyPdf()">Modify PDF</button>
    <p class="small">(Your browser will download the resulting file)</p>
</body>

<script>
    const { degrees, PDFDocument, rgb, StandardFonts } = PDFLib

    async function modifyPdf() {
        // Fetch an existing PDF document
        const url = 'https://jeandidier3.github.io/PCR.pdf'
        console.log("url ", url)
        const existingPdfBytes = await fetch(url).then(res => res.arrayBuffer())
        // Load a PDFDocument from the existing PDF bytes
        const pdfDoc = await PDFDocument.load(existingPdfBytes)

        // Embed the Helvetica font
        const helveticaFont = await pdfDoc.embedFont(StandardFonts.Helvetica)
       const helveticaBold= await pdfDoc.embedFont(StandardFonts.HelveticaBold)
       const helveticaOblique= await pdfDoc.embedFont(StandardFonts.HelveticaOblique)
        // Get the first page of the document
        const pages = pdfDoc.getPages()
        const firstPage = pages[0]

        // Get the width and height of the first page
        const { width, height } = firstPage.getSize()

        // Draw a string of text diagonally across the first page verdana pro en 11pt bold
        firstPage.drawText('Monsieur LOUARN GLENN', {
            x: 310,
            y: height / 2 + 255,
            size: 12,
            font: helveticaBold,
            color: rgb(0,0,0),
        })
        // verdana pro en 11pt bold
        firstPage.drawText(' LOUARN', {
            x: 343,
            y: height / 2 + 239,
            size: 11,
            font: helveticaBold,
            color: rgb(0,0,0),
        })
        // // verdana regular en 10pt bold
        firstPage.drawText('91 rue de la ville d\'ys'.toUpperCase(), {
            x: 310,
            y: height / 2 + 225,
            size: 11,
            font: helveticaFont,
            color: rgb(0,0,0),
        })
        // // verdana regular en 10pt bold
        firstPage.drawText('29200 BREST'.toUpperCase(), {
            x: 310,
            y: height / 2 + 195,
            size: 11,
            font: helveticaFont,
            color: rgb(0,0,0),
        })
        // verdana regular en 7pt bold (enregistré le)
        firstPage.drawText('13/08/2021     10h00', {
            x: 54,
            y: height / 2 + 177,
            size: 8,
            font: helveticaFont,
            color: rgb(0,0,0),
        })
        // verdana regular en 7pt bold (prélevé le)
        firstPage.drawText('13/08/2021', {
            x: 43,
            y: height / 2 + 169,
            size: 8,
            font: helveticaFont,
            color: rgb(0,0,0),
        })
        // verdana pro bold en 9pt bold code bizarre
        firstPage.drawText('24/10/2021-S-3214', {
            x: 73,
            y: height / 2 + 158,
            size: 11,
            font: helveticaBold,
            color: rgb(0,0,0),
        })
        // verdana regular en 7pt bold
        firstPage.drawText('24/10/1999 (21) (G)', {
            x: 80,
            y: height / 2 + 145,
            size: 7,
            font: helveticaFont,
            color: rgb(0,0,0),
        })
        // verdana italic en 7pt (validé le)
        firstPage.drawText('13/08/2021', {
            x: 390,
            y:  55,
            size: 7,
            font: helveticaFont,
            color: rgb(0,0,0),
        })

        // Serialize the PDFDocument to bytes (a Uint8Array)
        const pdfBytes = await pdfDoc.save()

        // Trigger the browser to download the PDF document
        download(pdfBytes, "pdf-lib_modification_example.pdf", "application/pdf");
    }
</script>

</html>
